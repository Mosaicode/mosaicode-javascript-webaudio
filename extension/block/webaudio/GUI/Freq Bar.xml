<?xml version="1.0" encoding="utf-8"?>
<MosaicodeBlock color="150:050:050:150" extension="webaudio" group="GUI" help="Freq Bar" label="Freq Bar" language="javascript" type="mosaicode_lib_javascript_webaudio.extensions.blocks.GUI.freqbar">
 <onload value="draw_freqbar$id$();"/>
 <execution value="
function draw_freqbar$id$(){
    var canvas = document.getElementById(&quot;canvas$id$&quot;);
    var canvasCtx = canvas.getContext(&quot;2d&quot;);
    var bufferLength = 64;
    var dataArray = new Uint8Array(bufferLength);
    var bufferLengthAlt = block_$id$.frequencyBinCount;

    canvasCtx.clearRect(0, 0, canvas.width, canvas.height);
    canvasCtx.lineWidth = 2;
    canvasCtx.strokeStyle = 'rgb(0, 0, 0)';

      block_$id$.getByteFrequencyData(dataArray);

      canvasCtx.clearRect(0, 0, canvas.width, canvas.height);
      canvasCtx.beginPath();


      var barWidth = (canvas.width / bufferLengthAlt) * 2.5;
      var barHeight;
      var x = 0;

      for(var i = 0; i &lt; bufferLengthAlt; i++) {
        barHeight = dataArray[i];
        canvasCtx.fillStyle = 'rgb(' + (barHeight+100) + ',50,50)';
        canvasCtx.fillRect(x, canvas.height - barHeight/2, barWidth, barHeight/2);
        x += barWidth + 1;
      }
      canvasCtx.stroke();
      drawVisual = requestAnimationFrame(draw_freqbar$id$);
}
"/>
 <html value='
&lt;canvas id="canvas$id$" class="visualizer" width="$prop[width]$" height="$prop[height]$"&gt;&lt;/canvas&gt;
'/>
 <declaration value="
// block_$id$ = $label$
var block_$id$ = context.createAnalyser();
block_$id$.fftSize = 256;
var $port[input]$ = block_$id$;
"/>
 <properties>
  <property value="{'upper': 32000, 'lower': 0, 'name': 'width', 'value': 640, 'label': 'Width', 'type': 'Float'}"/>
  <property value="{'upper': 32000, 'lower': 0, 'name': 'height', 'value': 240, 'label': 'Height', 'type': 'Float'}"/>
 </properties>
 <ports>
  <port conn_type="input" label="Sound" name_="input" type_="mosaicode_lib_javascript_webaudio.extensions.ports.sound"/>
 </ports>
</MosaicodeBlock>